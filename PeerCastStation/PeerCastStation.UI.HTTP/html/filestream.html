<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="robots" content="noindex,nofollow">
    <title>ファイル - PeerCastStation </title>
    <link rel="shortcut icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel="icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
    <link type="text/css" href="/Content/bootstrap.min.css" rel="stylesheet" />
    <link type="text/css" href="css/index.css" rel="stylesheet" />
    <script type="text/javascript" src="/Scripts/es5-shim.min.js"></script>
    <script type="text/javascript" src="/Scripts/es6-shim.min.js"></script>
    <script type="text/javascript" src="/Scripts/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="/Scripts/knockout-2.2.0.js"></script>
    <script type="text/javascript" src="/Scripts/bootstrap.min.js"></script>
    <script type="text/javascript" src="/api/1/peercaststation.js"></script>
    <script type="text/javascript" src="js/common.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/flv.js/1.6.1/flv.min.js"></script>
    <script type="text/javascript" src="js/filestream.js"></script>
    <script type="text/javascript">
      $(function() {
        $('.alert').alert();
        FileStreamViewModel.bind($('#uploadForm').get(0));
        UIViewModel.bind($('#header').get(0));
        var params = (new URL(document.location)).searchParams;
        var channelId = params.get('channelId');
        if(channelId){
            FileStreamViewModel.init(channelId);
        }
      });
    </script>
    <script type="text/html" id='alert'>
      <div class="alert alert-block fade in" data-bind="css:'alert-'+type, click:clicked">
        <a class="close" data-dismiss="alert" data-bind="css:'alert-'+type, click:close" href="#">&times;</a>
        <h4 data-bind="text:title"></h4>
        <p data-bind="text:message"></p>
      </div>
    </script>
    <style>
        img {
            object-fit: contain;
            width: 240px;
            height: 240px;
            border: solid 1px #ccc;
        }
        textarea {
            width: 100%;
        }
        .progress .bar {
            -webkit-transition: none;
            -moz-transition: none;
            -ms-transition: none;
            -o-transition: none;
            transition: none;
        }​
    </style>
  </head>
  <body>
    <div id="header">
      <div class="alerts" data-bind="template: { name: 'alert', foreach: alerts }"></div>
      <div class="navbar">
        <div class="navbar-inner">
          <div class="container-fluid">
            <a class="brand" href="#">PeerCastStation</a>
            <ul class="nav">
              <li><a href="index.html">情報</a></li>
              <li><a href="channels.html">Yellow Page</a></li>
              <li><a href="relays.html">リレー</a></li>
              <li><a href="settings.html">設定</a></li>
              <li><a href="logs.html">ログ</a></li>
              <li class="active"><a href="filestream.html">ファイルストリーム</a></li>
              <li><a href="/help/index.html">ヘルプ</a></li>
            </ul>
            <a class="btn btn-warning pull-right" data-bind="css:{hidden:!newVersionAvailable()}" href="update.html" target="_blank">バージョンアップ</a>
          </div>
        </div>
      </div>
    </div>
    <div class="container-fluid">
      <h1>ファイルストリーム</h1>
      <div class="mainContainer" style="padding:3rem">
          <div id="uploadForm" class="mb-3" style="display: none;">
            <input type="file" class="form-control me-2" id="uploadImage" />
            <button class="btn" data-bind="click:upload">送信</button>
            <div class="progress" style="display: none;">
            <div id="uploadStatus" class="bar" style="width: 0%;"></div>
            </div>
          </div>
          <div id="streamURL">
              <div class="url-input">
                  <label for="sURL">Stream URL:</label>
                  <input id="sURL" type="text" value="" />
                  <button class="btn" onclick="flv_load()">Load</button>
              </div>
              <div class="options" class="hidden" style="display: none;">
                  <button onclick="switch_mds()" style="display: none;">Switch to MediaDataSource</button>
                  <input type="checkbox" id="isLive" onchange="saveSettings()" checked />
                  <label for="isLive">isLive</label>
                  <input type="checkbox" id="withCredentials" onchange="saveSettings()" />
                  <label for="withCredentials">withCredentials</label>
                  <input type="checkbox" id="hasAudio" onchange="saveSettings()" checked />
                  <label for="hasAudio">hasAudio</label>
                  <input type="checkbox" id="hasVideo" onchange="saveSettings()" />
                  <label for="hasVideo">hasVideo</label>
              </div>
          </div>
          <div id="mediaSourceURL" class="hidden">
              <div class="url-input">
                  <label for="msURL">MediaDataSource JsonURL:</label>
                  <input id="msURL" type="text" value="" />
                  <button onclick="switch_url()">Switch to URL</button>
              </div>
          </div>
      </div>
      <hr>
      <div id="imgContainer"></div>
      <div class="video-container">
          <div>
              <video name="videoElement" class="centeredVideo" controls autoplay>
                  Your browser is too old which doesn't support HTML5 video.
              </video>
          </div>
      </div>
      <div class="controls" class="hidden" style="display: none;">
          <button onclick="flv_load()">Load</button>
          <button onclick="flv_start()">Start</button>
          <button onclick="flv_pause()">Pause</button>
          <button onclick="flv_destroy()">Destroy</button>
          <input style="width:100px" type="text" name="seekpoint"/>
          <button onclick="flv_seekto()">SeekTo</button>
      </div>
      <textarea name="logcatbox" class="logcatBox" rows="10" readonly></textarea>
    </div>

  </body>
</html>

